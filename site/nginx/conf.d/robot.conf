server {
    location /ros/ {
        proxy_pass http://robot-web-video-server-1:8080/;
        proxy_http_version 1.1;
        proxy_set_header Connection "";
        proxy_buffering off;
    }
  listen 80;
  server_name _;

  # Static
  location / {
    root /usr/share/nginx/html;
    index index.html;
  }

  # Metrics
  # Proxy system telemetry to the netstatus backend (container: robot-netstatus-1)
  location = /status          { proxy_pass http://robot-netstatus-1:5000/status; }
  location = /status_temp     { proxy_pass http://robot-netstatus-1:5000/status_temp; }
  location = /status_uptime   { proxy_pass http://robot-netstatus-1:5000/status_uptime; }

  # Web Video Server (MJPEG) â€” streaming-friendly proxy
  location /wvs/ {
    proxy_pass http://web-video-server:8080/;
    proxy_http_version 1.1;
    proxy_set_header Host $host;

    # critical for MJPEG streaming
    proxy_buffering off;
    proxy_request_buffering off;
    proxy_cache off;
    sendfile off;
    tcp_nodelay on;
    proxy_set_header Connection "";

    proxy_read_timeout 3600s;
    proxy_send_timeout 3600s;

    add_header X-Accel-Buffering no;
    add_header X-Proxy wvs;
  }
}
