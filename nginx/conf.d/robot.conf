server {
  listen 80 default_server;
  server_name _;

  root /usr/share/nginx/html;
  index index.html;

  # Docker DNS for service/container names
  resolver 127.0.0.11 ipv6=off valid=30s;

  # ---- Web Video Server ----
  location /stream {
    proxy_http_version 1.1;
    proxy_buffering off;
    proxy_set_header Connection "";
    proxy_read_timeout 1h;
    proxy_send_timeout 1h;
    proxy_pass http://web-video-server:8080/stream$is_args$args;
  }

  location /snapshot {
    proxy_http_version 1.1;
    proxy_buffering off;
    proxy_set_header Connection "";
    proxy_read_timeout 30s;
    proxy_pass http://web-video-server:8080/snapshot$is_args$args;
  }

  # (Optional) Health
  location = /healthz { return 200 'ok'; add_header Content-Type text/plain; }
}
